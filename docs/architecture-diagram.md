# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã MSE Telegram Bot

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    subgraph "ü§ñ Telegram Bot Layer"
        TG[Telegram Bot API]
        CMD[–°–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥]
        MSG[–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π]
        CB[Callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫]
    end
    
    subgraph "üìã –ö–æ–º–∞–Ω–¥—ã"
        START[/start - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è]
        SURVEY[/survey - –û–ø—Ä–æ—Å]
        STATS[/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
        SETTINGS[/settings - –ù–∞—Å—Ç—Ä–æ–π–∫–∏]
        EXPORT[/export - –≠–∫—Å–ø–æ—Ä—Ç]
        HELP[/help - –ü–æ–º–æ—â—å]
    end
    
    subgraph "üß† –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ò–ò"
        MV[MomentValidator<br/>–ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è]
        GS[GoldenStandard<br/>–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã]
        AI[AI Validator Service<br/>OpenAI/Anthropic]
        FU[FollowUp Strategy<br/>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã]
    end
    
    subgraph "‚öôÔ∏è –°–µ—Ä–≤–∏—Å—ã"
        NS[NotificationScheduler<br/>–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π]
        TS[TrainingService<br/>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏–µ–º]
        DE[DataExporter<br/>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö]
        DB[Database Service<br/>MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ]
    end
    
    subgraph "üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö"
        USER[(User<br/>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)]
        RESP[(Response<br/>–û—Ç–≤–µ—Ç—ã –Ω–∞ –æ–ø—Ä–æ—Å—ã)]
        TRAIN[(TrainingProgress<br/>–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è)]
    end
    
    subgraph "üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
        METRICS[–°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫]
        HEALTH[Health Check]
        LOGS[–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ]
    end
    
    subgraph "üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"
        HURLBURT[hurlburt.js<br/>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ—Ç–æ–¥–∞]
        GOLDEN[golden-examples.js<br/>–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã]
        ENV[.env<br/>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è]
    end
    
    %% Connections
    TG --> CMD
    TG --> MSG
    TG --> CB
    
    CMD --> START
    CMD --> SURVEY
    CMD --> STATS
    CMD --> SETTINGS
    CMD --> EXPORT
    CMD --> HELP
    
    SURVEY --> MV
    MV --> GS
    GS --> AI
    AI --> FU
    
    START --> USER
    SURVEY --> RESP
    SURVEY --> TRAIN
    STATS --> RESP
    SETTINGS --> USER
    EXPORT --> DE
    
    NS --> USER
    TS --> TRAIN
    DE --> RESP
    DB --> USER
    DB --> RESP
    DB --> TRAIN
    
    MV --> HURLBURT
    GS --> GOLDEN
    AI --> ENV
    NS --> ENV
    
    SURVEY --> METRICS
    AI --> METRICS
    NS --> METRICS
    
    HEALTH --> USER
    HEALTH --> RESP
    HEALTH --> TRAIN
    HEALTH --> AI
    
    %% Styling
    classDef botLayer fill:#e3f2fd
    classDef commands fill:#f3e5f5
    classDef validation fill:#fce4ec
    classDef services fill:#e8f5e8
    classDef data fill:#fff3e0
    classDef monitoring fill:#f1f8e9
    classDef config fill:#fafafa
    
    class TG,CMD,MSG,CB botLayer
    class START,SURVEY,STATS,SETTINGS,EXPORT,HELP commands
    class MV,GS,AI,FU validation
    class NS,TS,DE,DB services
    class USER,RESP,TRAIN data
    class METRICS,HEALTH,LOGS monitoring
    class HURLBURT,GOLDEN,ENV config
```

## –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—É—Ç–∏

```mermaid
flowchart TD
    A[üë§ –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B[/start - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è]
    B --> C{–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω?}
    C -->|–î–∞| D[üìã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ]
    C -->|–ù–µ—Ç| E[‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏]
    
    D --> F[‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π]
    F --> G[üìö –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã]
    G --> H[üéØ –ù–∞—á–∞–ª–æ 3-–¥–Ω–µ–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è]
    
    H --> I[üì± –ü–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è]
    I --> J{–û—Ç–≤–µ—Ç–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞?}
    J -->|–ù–µ—Ç| K[üîî –≠—Å–∫–∞–ª–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π]
    K --> L{–î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º —ç—Å–∫–∞–ª–∞—Ü–∏–∏?}
    L -->|–î–∞| M[üò¥ –ü–∞—É–∑–∞ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è]
    L -->|–ù–µ—Ç| N[üì¢ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ]
    N --> J
    
    J -->|–î–∞| O[üìù –ù–∞—á–∞–ª–æ –æ–ø—Ä–æ—Å–∞]
    O --> P[üí≠ –í–æ–ø—Ä–æ—Å –æ —Ç–µ–∫—É—â–µ–º –º–æ–º–µ–Ω—Ç–µ]
    P --> Q[‚úçÔ∏è –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    Q --> R[ü§ñ –ò–ò-–≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞]
    
    R --> S{–ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞}
    S -->|–ù–∏–∑–∫–æ–µ < 40%| T[üìñ –û–±—É—á–∞—é—â–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å]
    S -->|–°—Ä–µ–¥–Ω–µ–µ 40-70%| U[üí° –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–≤–µ—Ç—ã]
    S -->|–í—ã—Å–æ–∫–æ–µ > 70%| V[üéâ –ü–æ–∑–∏—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å]
    
    T --> W{–ù—É–∂–µ–Ω follow-up?}
    U --> W
    V --> W
    
    W -->|–î–∞| X[‚ùì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å]
    X --> Y[‚úçÔ∏è –û—Ç–≤–µ—Ç –Ω–∞ follow-up]
    Y --> Z[üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫]
    
    W -->|–ù–µ—Ç| Z
    Z --> AA[üìà –†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–Ω—è]
    
    AA --> BB{–ó–∞–≤–µ—Ä—à–µ–Ω –¥–µ–Ω—å –æ–±—É—á–µ–Ω–∏—è?}
    BB -->|–ù–µ—Ç| CC[‚è∞ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–ø—Ä–æ—Å–∞]
    CC --> I
    
    BB -->|–î–∞| DD{–í—Å–µ 3 –¥–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã?}
    DD -->|–ù–µ—Ç| EE[üåÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é]
    EE --> FF[üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞]
    FF --> GG[üéØ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏]
    GG --> I
    
    DD -->|–î–∞| HH[üéì –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è]
    HH --> II[üìã –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞]
    II --> JJ[üìä –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
    JJ --> KK[üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö]
    
    KK --> LL[üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è]
    LL --> MM[üì± –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–ø—Ä–æ—Å—ã]
    MM --> NN[üìà –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
    
    M --> OO[üìÖ –ù–æ–≤—ã–π –¥–µ–Ω—å]
    OO --> I
    
    style A fill:#e1f5fe
    style H fill:#f3e5f5
    style HH fill:#e8f5e8
    style KK fill:#fff3e0
    style R fill:#fce4ec
    style T fill:#ffebee
    style V fill:#e8f5e8
```

## –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –æ–±—É—á–µ–Ω–∏—è

```mermaid
stateDiagram-v2
    [*] --> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è --> –ù–∞—Å—Ç—Ä–æ–π–∫–∞–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    –ù–∞—Å—Ç—Ä–æ–π–∫–∞–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π --> –î–µ–Ω—å1
    
    state "3-–¥–Ω–µ–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ" as –û–±—É—á–µ–Ω–∏–µ {
        –î–µ–Ω—å1 --> –î–µ–Ω—å2 : –ó–∞–≤–µ—Ä—à–µ–Ω –¥–µ–Ω—å 1
        –î–µ–Ω—å2 --> –î–µ–Ω—å3 : –ó–∞–≤–µ—Ä—à–µ–Ω –¥–µ–Ω—å 2
        –î–µ–Ω—å3 --> –í—ã–ø—É—Å–∫ : –ó–∞–≤–µ—Ä—à–µ–Ω –¥–µ–Ω—å 3
        
        state –î–µ–Ω—å1 {
            [*] --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è1
            –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è1 --> –û–ø—Ä–æ—Å1 : –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            –û–ø—Ä–æ—Å1 --> –í–∞–ª–∏–¥–∞—Ü–∏—è1 : –û—Ç–≤–µ—Ç
            –í–∞–ª–∏–¥–∞—Ü–∏—è1 --> –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å1 : –ê–Ω–∞–ª–∏–∑
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å1 --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è1 : –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å1 --> [*] : –î–µ–Ω—å –∑–∞–≤–µ—Ä—à–µ–Ω
        }
        
        state –î–µ–Ω—å2 {
            [*] --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è2
            –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è2 --> –û–ø—Ä–æ—Å2 : –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            –û–ø—Ä–æ—Å2 --> –í–∞–ª–∏–¥–∞—Ü–∏—è2 : –û—Ç–≤–µ—Ç
            –í–∞–ª–∏–¥–∞—Ü–∏—è2 --> –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å2 : –ê–Ω–∞–ª–∏–∑
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å2 --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è2 : –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å2 --> [*] : –î–µ–Ω—å –∑–∞–≤–µ—Ä—à–µ–Ω
        }
        
        state –î–µ–Ω—å3 {
            [*] --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è3
            –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è3 --> –û–ø—Ä–æ—Å3 : –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            –û–ø—Ä–æ—Å3 --> –í–∞–ª–∏–¥–∞—Ü–∏—è3 : –û—Ç–≤–µ—Ç
            –í–∞–ª–∏–¥–∞—Ü–∏—è3 --> –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å3 : –ê–Ω–∞–ª–∏–∑
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å3 --> –û–∂–∏–¥–∞–Ω–∏–µ–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è3 : –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
            –û–±—Ä–∞—Ç–Ω–∞—è–°–≤—è–∑—å3 --> [*] : –î–µ–Ω—å –∑–∞–≤–µ—Ä—à–µ–Ω
        }
    }
    
    –í—ã–ø—É—Å–∫ --> –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ : –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
    
    state –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ {
        [*] --> –†–µ–≥—É–ª—è—Ä–Ω—ã–µ–û–ø—Ä–æ—Å—ã
        –†–µ–≥—É–ª—è—Ä–Ω—ã–µ–û–ø—Ä–æ—Å—ã --> –ê–Ω–∞–ª–∏–∑–î–∞–Ω–Ω—ã—Ö : –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        –ê–Ω–∞–ª–∏–∑–î–∞–Ω–Ω—ã—Ö --> –†–µ–≥—É–ª—è—Ä–Ω—ã–µ–û–ø—Ä–æ—Å—ã : –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        –ê–Ω–∞–ª–∏–∑–î–∞–Ω–Ω—ã—Ö --> –≠–∫—Å–ø–æ—Ä—Ç–î–∞–Ω–Ω—ã—Ö : –ü–æ –∑–∞–ø—Ä–æ—Å—É
        –≠–∫—Å–ø–æ—Ä—Ç–î–∞–Ω–Ω—ã—Ö --> –†–µ–≥—É–ª—è—Ä–Ω—ã–µ–û–ø—Ä–æ—Å—ã
    }
    
    –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ --> [*] : –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—á–∞—Å—Ç–∏—è
```
